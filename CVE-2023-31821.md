**Vulnerability name:**  Exposure of secret in ALBIS

##### 1. Vulnerability description

The mini-app **'ALBIS'** on Line exposes the critical credential, the **'client secret'**, to the client-side, enabling remote attackers to obtain the secret. This client secret can then be utilized to **acquire the channel access token**, which **is responsible for securing the communication channel** within Line and can **be exploited to broadcast malicious messages**.

**Affected version:** Line 13.6.1

##### 2. Attack Vectors

The exploit only requires that the client simply has Line installed and open the mini-app 'ALBIS' on Line. The response of the following request: [https://api/retailstudio.jp/api/v2/get_media_info](https://api/retailstudio.jp/api/v2/get_media_info), contains the critical credential, the client secret. Then we verify the effectiveness of this secret using the tool supplied by Line.

<center>
    <img style="border-radius: 0.3125em;    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="images\9.png" width="600px">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;    display: inline-block;    color: #999;    padding: 2px;">Figure 1 Leakage of client secret</div>
</center>

Figure 1 shows the response of request [https://api/retailstudio.jp/api/v2/get_media_info](https://api/retailstudio.jp/api/v2/get_media_info) leaks the client secret of Line which is strictly prohibited from being leaked.  As shown in Figure 2, the client secret can be utilized to acquire the channel access token which is responsible for securing the communication channel within Line.

<center>
      <img style="border-radius: 0.3125em;    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
      src="images\10.png" width="600px">
      <br>
      <div style="color:orange; border-bottom: 1px solid #d9d9d9;    display: inline-block;    color: #999;    padding: 2px;">Figure 2 Exchange the channel access token with client secret</div>
  </center>

The official definition of channel access token is depicted in the following figure. It's obvious that keeping the channel access token secret is important. An attacker can utilize the channel to broadcast malicious messages if the channel access token is exposed.

<center>
      <img style="border-radius: 0.3125em;    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
      src="images\line channel.png" width="600px">
      <br>
      <div style="color:orange; border-bottom: 1px solid #d9d9d9;    display: inline-block;    color: #999;    padding: 2px;">Figure 3 The official description of channel access token</div>
  </center>

##### 3.Â  Vulnerability affected

This vulnerability can have an impact on any mini-app 'ALBIS' user. Users will be at risk of getting malicious broadcast messages as a result of this vulnerability, such as website links, fraud information and so on.

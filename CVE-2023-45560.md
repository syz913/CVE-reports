The following is the URL of this product:
[https://liff.line.me/1657740200-jeMRopV8](https://liff.line.me/1657740200-jeMRopV8)

Unlike traditional apps that are downloaded directly from app markets like Google Play, this product requires access through some steps. Let's take CVE-2023-43297-'animal-art-lab' as an example:

**1. open the url in the website, then you can see a QR code, which points to the product**

<center>
    <img style="border-radius: 0.3125em;    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="images\qr.png" width="600px">
    <br>
</center>

**2. open app 'Line' on the phone and scan the QR code**

<center>
    <img style="border-radius: 0.3125em;    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="images\line.png" width="400px">
    <br>
</center>

**3. you can successfully download open the product**

<center>
    <img style="border-radius: 0.3125em;    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="images\lab.png" width="400px">
    <br>
</center>


**Vulnerability name:**  Exposure of secret in Yasukawa memberscard

**Affected product:** Yasukawa memberscard

**Affected version:** v13.6.1


**Vulnerability type:** Exposure of Sensitive Information to an Unauthorized Actor (CWE-200)


**Vulnerability name:**  Exposure of secret in Yasukawa memberscard

##### 1. Vulnerability description

The mini-app **'Yasukawa memberscard'** on Line exposes the critical credential, the **'client secret'**, to the client-side, enabling remote attackers to obtain the secret. This client secret can then be utilized to **acquire the channel access token**, which **is responsible for securing the communication channel** within Line and can **be exploited to broadcast malicious messages**.


##### 2. Attack Vectors

The exploit only requires that the client simply has Line installed and open the mini-app ‘Yasukawa memberscard’ on Line. The response of the following request: [https://asia-northeast1-pibot-order-prod.cloudfunctions.net/userEntry](https://asia-northeast1-pibot-order-prod.cloudfunctions.net/userEntry), contains the critical credential,  the client secret. Then we verify the effectiveness of this secret using the tool supplied by Line.

<center>
    <img style="border-radius: 0.3125em;    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="images\memberscard1.png" width="600px">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;    display: inline-block;    color: #999;    padding: 2px;">Figure 1 Leakage of client secret</div>
</center>

Figure 1 shows the response of request [https://asia-northeast1-pibot-order-prod.cloudfunctions.net/userEntry](https://asia-northeast1-pibot-order-prod.cloudfunctions.net/userEntry) leaks the client secret of Line which is strictly prohibited from being leaked. As shown in Figure 2, the client secret can be utilized to acquire the channel access token which is responsible for securing the communication channel within Line.

<center>
      <img style="border-radius: 0.3125em;    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
      src="images\memberscard2.png" width="600px">
      <br>
      <div style="color:orange; border-bottom: 1px solid #d9d9d9;    display: inline-block;    color: #999;    padding: 2px;">Figure 2 Exchange the channel access token with client secret</div>
  </center>

The official definition of channel access token is depicted in the following figure. It's obvious that keeping the channel access token secret is important. An attacker can utilize the channel to broadcast malicious messages if the channel access token is exposed.

<center>
      <img style="border-radius: 0.3125em;    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
      src="images\line channel.png" width="600px">
      <br>
      <div style="color:orange; border-bottom: 1px solid #d9d9d9;    display: inline-block;    color: #999;    padding: 2px;">Figure 3 The official description of channel access token</div>
  </center>

##### 3.  Vulnerability affected

This vulnerability can have an impact on any mini-app ‘Yasukawa memberscard’ user. Users will be at risk of getting malicious broadcast messages as a result of this vulnerability, such as website links, fraud information and so on.
